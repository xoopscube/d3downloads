<div class="ui-dev-mode"><{$smarty.template}></div>

<!--<script type="text/javascript" src="<{$mod_url}>/index.php?page=module_header&src=jquery.js"></script>-->

<script type="text/javascript" src="<{$mod_url}>/index.php?page=module_header&src=d3downloads.js"></script>

<h3><{$smarty.const._MD_D3DOWNLOADS_H2BROKENMANAGER}> ( <{$total_num}> )</h3>

<{if $iserror}>
	<div class="error">
		<{$error_message}>
	</div>
<{/if}>


<div class="tips">
	<{$smarty.const._MD_D3DOWNLOADS_HELP_BROKENCHECK}>
</div>


<form name="brokenmanager" id="brokenmanager" action="<{$mod_url}>/admin/index.php?page=<{$page}>" method="post">
<{$gticket_hidden}>

<table class="outer">
	<thead>
	<tr style="text-align:center;">
		<th>
			<{$smarty.const._MD_D3DOWNLOADS_TH_TITLE}>
		</th>
		<th>
			<{$smarty.const._MD_D3DOWNLOADS_TH_REPORT}>
		</th>
		<th nowrap="nowrap">
			<{$smarty.const._MD_D3DOWNLOADS_TH_BROKENDEL}>
			<input type="checkbox" onclick="col_check_on_off( this, 'col_brokendel_' )">
		</th>
		<th style="text-align:right;">
			<{$smarty.const._MD_D3DOWNLOADS_TH_CONTENTSACTIONS}>
			<input type="checkbox" onclick="col_check_on_off( this, 'col_action_' )">
		</th>
	</tr>
	</thead>
	<tbody>
	<{foreach from=$broken.file item="item"}>
		<tr class="<{cycle values="even,odd"}>">
			<td style="vertical-align:middle;">
				<{if ! $item.broken_link}>
					<{$item.filelink}><{$item.title}></a>
				<{else}>
					<{$item.title}>
					<br>
					( <span style="font-size: small; color: #e43140;font-weight: bold;"><{$smarty.const._MD_D3DOWNLOADS_BROKEN_FILE}></span> )
				<{/if}>
				<br>
				<{if $item.filename_link}>
					<{$item.filename_link}><br>
				<{/if}>
				<{if $item.filename_link2}>
					<{$item.filename_link2}><br>
				<{/if}>
			</td>
			<td width="50%" style="text-align:center;vertical-align:middle;">
				<table class="outer">
					<tr>
						<th>
							<{$smarty.const._MD_D3DOWNLOADS_TH_SENDERNAME}>
						</th>
						<th>
							<{$smarty.const._MD_D3DOWNLOADS_TH_IP}>
						</th>
						<th>
							<{$smarty.const._MD_D3DOWNLOADS_TH_REPORTDATE}>
						</th>
					<tr>
						<{foreach from=$item.report item="broken" name="broken"}>
							<td>
								<{$broken.sendername}>
								<{if $broken.mail_link}><br /><{$broken.mail_link}><{/if}>
							</td>
							<td>
								<{$broken.ip}>
							</td>
							<td>
								<{$broken.date}>
							</td>
						<{if $broken.message}>
						</tr>
						<tr>
						<td colspan="3">
						<span style="font-weight: bold;">Message :</span><br /><{$broken.message}>
						</td>
						<{/if}>
					</tr>
						<{/foreach}>
				</table>

				<span style="font-size:smaller;">( Total : <{$smarty.foreach.broken.total}> )</span>
			<td nowrap="nowrap" style="text-align:center;vertical-align:middle;">
				<input type="checkbox" name="brokendel[<{$item.lid}>]" id="col_brokendel_<{$item.lid}>" value="1">
			</td>
			<td nowrap="nowrap" style="text-align:right;vertical-align:middle;">
				<a href="<{$mod_url}>/index.php?page=singlefile&amp;cid=<{$item.cid}>&amp;lid=<{$item.lid}>">
					<{$smarty.const._MD_D3DOWNLOADS_VISIBLE}></a> |
				<a href="<{$mod_url}>/index.php?page=modfile&amp;cid=<{$item.cid}>&amp;lid=<{$item.lid}>">
					<{$smarty.const._EDIT}></a> |
					<input type="checkbox" name="action_selects[<{$item.lid}>]" id="col_action_<{$item.lid}>" value="1">
					<br>
					<{$item.postname}>
				</a>
				<br>
				<{$item.updated}>
			</td>
		</tr>
	<{/foreach}>
	</tbody>
	<tfoot>
	<tr>
		<td colspan="11" align="center" class="head">
			<input type="submit" name="brokenmanager_update" id="brokenmanager_update" value="<{$smarty.const._SUBMIT}>" tabindex="0">
		</td>
	</tr>
	<tr>
		<th colspan="11" style="text-align:right;">
			<{$smarty.const._MD_D3DOWNLOADS_LABEL_FILECHECKED}>
			<input type="submit" name="delete" id="delete" value="<{$smarty.const._MD_D3DOWNLOADS_BTN_DELETE}>">
			<input type="submit" name="invisible" id="invisible" value="<{$smarty.const._MD_D3DOWNLOADS_BTN_INVISIBLE}>">
		</th>
	</tr>
	<tr>
		<td colspan="11" align="center" class="head">
			<input type="submit" name="brokencheck" id="brokencheck" value="<{$smarty.const._MD_D3DOWNLOADS_LABEL_BROKENCHECK}>">
			limit : <input name="limit" size="5" type="text" value="<{$limit}>">&nbsp;offset : <input name="offset" size="5" type="text" value="0">
		</td>
	</tr>
	<tr>
		<th colspan="11" align="center">
			<{$smarty.const._MD_D3DOWNLOADS_NOLINK_CHECK}> <{$nolinkfile}> Files ( total <{$totalfile}> Files )
		</th>
	</tr>
	</tfoot>
</table>
</form>



<script type="text/javascript">
<!--//
jQuery( function($){
	$( '#brokenmanager_update' ).click( function(){
		infoDom_initialize() ;
		col_action_check( 'col_brokendel_' ) ;
		if( validate_checked == 0 ){
			popup_info( '<{$smarty.const._MD_D3DOWNLOADS_ERROR_SEL_REPORT}>' )
			return false ;
		}
    });

	$( '#delete' ).click( function(){
		infoDom_initialize() ;
		col_action_check( 'col_action_' ) ;
		if( validate_checked > 0 ){
			return confirm('<{$smarty.const._MD_D3DOWNLOADS_CONFIRM_DELETE}>') ;
		} else {
			popup_info( '<{$smarty.const._MD_D3DOWNLOADS_ERROR_SEL_FILSE}>' )
			return false ;
		}
    });

	$( '#invisible' ).click( function(){
		infoDom_initialize() ;
		col_action_check( 'col_action_' ) ;
		if( validate_checked > 0 ){
			return confirm('<{$smarty.const._MD_D3DOWNLOADS_CONFIRM_INVISIBLE}>') ;
		} else {
			popup_info( '<{$smarty.const._MD_D3DOWNLOADS_ERROR_SEL_FILSE}>' )
			return false ;
		}
    });

	$( '#brokencheck' ).click( function(){
		return confirm('<{$smarty.const._MD_D3DOWNLOADS_CONFIRM_BROKENCHECK}>') ;
    });
});
//-->
</script>
